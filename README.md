# 우아한테크코스 스터디룸 예약 관리

## 🧪 테스트 실행 가이드
- 기능 구현을 완료한 후 아래 가이드에 따라 모든 테스트가 성공적으로 실행되는지 확인한다.
- 테스트가 실패하면 점수가 0점이 되므로 제출하기 전에 반드시 확인한다.

### 테스트 실행
- 터미널에서 `java -version` 을 실행하여 Java 버전이 21인지 확인한다.
- 터미널에서 Mac 또는 Linux 사용자는 `./gradlew clean test` 를 실행하고,
  Windows 사용자는 `gradlew.bat clean test` 또는 `./gradlew.bat clean test` 를 실행한다.

## 📌 과제 진행 요구 사항
- 기능을 구현하기 전 `README.md` 에 구현할 기능 목록을 정리해 추가한다.
- Git 커밋 단위는 기능 목록 단위로 한다.
- 프로그램은 사용자가 종료할 때까지 종료되지 않으며, 기능을 수행한 후 초기 화면으로 돌아간다.
- 사용자가 잘못된 값을 입력한 경우 `[ERROR]` 로 시작하는 메시지와 함께 `IllegalArgumentException` 을 발생시킨 후 애플리케이션을 종료한다.

---

## 🎯 기능 요구 사항

### 배경
크루들이 스터디룸을 예약하는데, 겹치는 예약/노쇼가 반복되며 운영 부담이 커졌다.
스터디룸 예약과 체크인을 관리하는 **간단한 콘솔 프로그램**을 만든다.

### 관리 기간
- 시스템이 관리하는 기간은 **2026년 1월 1일 ~ 2026년 1월 31일**이다.

### 공간(스터디룸)
- 스터디룸은 `A`, `B`, `C` 세 개가 있다.
- 한 방에는 동시에 **하나의 예약만** 존재할 수 있다(시간 겹침 금지).

### 운영일/휴일
- **주말(토/일) 및 휴일에는 예약/체크인/수정이 불가능**하다.
- 휴일 정보는 `src/main/resources/holidays.csv` 로 제공한다(수정 금지).

### 운영 시간 및 예약 단위
- 운영 시간: **09:00 ~ 22:00**
- 예약 시작/종료는 **30분 단위**여야 한다.
  - 예: `09:00`, `09:30`, `10:00` ...
- 예약은 최소 30분, 최대 2시간까지 가능하다.
- 예약 종료 시각은 시작 시각보다 늦어야 한다.
- 운영 시간을 벗어나는 예약은 불가능하다.
  - 예: `21:30~22:30` 불가

### 체크인 규칙(상태)
체크인은 예약 시작 시각 기준으로 상태가 결정된다.

- **정상 체크인(ON_TIME)**: 시작 시각 `-10분` ~ `+10분` 사이 체크인
- **지각 체크인(LATE)**: 시작 시각 `+10분 초과` ~ 예약 종료 이전 체크인
- **노쇼(NO_SHOW)**: 예약 종료 시각이 지났는데 체크인이 없는 경우

> “현재 시각”은 `mission-utils` 의 `DateTimes.now()` 를 사용해 계산한다.

### 패널티 규칙
- 지각 1회 = 패널티 1점
- 노쇼 1회 = 패널티 2점
- 패널티 점수는 **최근 14일(오늘 포함)**의 기록만 합산한다.
- 패널티가 **5점 이상이면 예약 불가 상태(BLOCK)** 로 간주한다.
  - BLOCK 상태인 크루는 “예약 등록”을 할 수 없다.

### 초기 데이터
- 등록된 크루 목록: `src/main/resources/members.csv` (수정 금지)
- 기존 예약/체크인 기록: `src/main/resources/reservations.csv` (수정 금지)

`reservations.csv` 형식:
```
nickname,room,start,end,checkin
빙티,A,2026-01-06 19:00,2026-01-06 20:00,
이든,B,2026-01-06 20:30,2026-01-06 21:30,2026-01-06 20:33
```

---

## 🧩 구현해야 할 기능

### 1) 예약 등록
- 입력: 닉네임, 룸(A/B/C), 예약 시작(HH:mm), 예약 종료(HH:mm)
- 규칙:
  - 등록되지 않은 닉네임이면 에러
  - 주말/휴일이면 에러
  - 운영 시간/30분 단위/최대 2시간 등 정책 위반이면 에러
  - 기존 예약과 시간이 겹치면 에러(같은 룸 기준)
  - BLOCK 상태(최근 14일 패널티 >= 5)인 크루는 예약 불가(에러)
  - 동일 크루는 “미래 예약”을 최대 3개까지만 보유 가능(초과 시 에러)
- 출력: 예약 정보와 “예약 완료!” 문구

### 2) 체크인
- 입력: 닉네임, 룸(A/B/C)
- 규칙:
  - 오늘 날짜의 해당 룸 예약이 존재해야 한다(없으면 에러)
  - 이미 체크인한 예약이면 에러
  - 체크인은 운영일에만 가능(주말/휴일이면 에러)
  - 체크인 시각은 `DateTimes.now()` 기준이며, 체크인 후 상태(ON_TIME/LATE)를 출력한다.

### 3) 룸 스케줄 조회
- 입력: 룸(A/B/C), 조회할 날짜(일)
- 출력:
  - 해당 날짜의 예약을 시작 시각 오름차순으로 출력한다.
  - 각 예약은 아래 형태로 출력한다.
    - `19:00~20:00 빙티 (NO_SHOW)`
  - 상태 판정:
    - 체크인 시각이 있으면 ON_TIME/LATE로 판정
    - 체크인 시각이 없고, “현재 시각”이 예약 종료 이후면 NO_SHOW
    - 체크인 시각이 없고, 아직 예약 종료 전이면 PENDING
  - 예약이 없으면 “예약이 없습니다.”를 출력한다.

### 4) 패널티/예약불가 크루 조회
- 전날까지의 기록을 바탕으로(오늘 예약은 제외) 크루들의 최근 14일 패널티를 계산해 출력한다.
- 출력은 패널티 점수 내림차순으로 정렬한다.
- 동점일 때 정렬 기준:
  1) 패널티 점수 내림차순  
  2) 노쇼 횟수 내림차순  
  3) 지각 횟수 내림차순  
  4) 닉네임 오름차순
- 패널티가 5점 이상인 크루는 이름 옆에 `(BLOCK)` 을 표시한다.

---

## ⌨️ 입출력 요구 사항

### 초기 화면
```
오늘은 1월 6일 화요일입니다. 기능을 선택해 주세요.
1. 예약 등록
2. 체크인
3. 룸 스케줄 조회
4. 패널티/예약불가 크루 조회
Q. 종료
```

### 에러 메시지 예시
- 형식 오류
```
[ERROR] 잘못된 형식을 입력하였습니다.
```
- 등록되지 않은 닉네임
```
[ERROR] 등록되지 않은 닉네임입니다.
```
- 운영일이 아님
```
[ERROR] 1월 1일 목요일은 운영일이 아닙니다.
```
- 예약 시간 충돌
```
[ERROR] 해당 시간에는 이미 예약이 존재합니다.
```
- 예약 단위 위반
```
[ERROR] 예약 시각은 30분 단위여야 합니다.
```

---

## 🧑‍💻 프로그래밍 요구 사항
- JDK 21 버전에서 실행 가능해야 한다.
- 프로그램 실행의 시작점은 `Application` 의 `main()` 이다.
- CSV 파일을 통해 초기 데이터를 불러온다.
- `System.exit()` 를 사용하지 않는다.
- indent(인덴트)는 3이 넘지 않도록 한다.
- else를 지양한다.
- 도메인 로직을 UI(입출력)에서 분리한다.
